{"remainingRequest":"C:\\Users\\86185\\AppData\\Roaming\\npm\\node_modules\\@vue\\cli-service-global\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Files\\Learning_Files\\Vue\\vue_test\\components\\TakePhotos\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\Files\\Learning_Files\\Vue\\vue_test\\components\\TakePhotos\\index.vue","mtime":1645755034492},{"path":"C:\\Users\\86185\\AppData\\Roaming\\npm\\node_modules\\@vue\\cli-service-global\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\86185\\AppData\\Roaming\\npm\\node_modules\\@vue\\cli-service-global\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\86185\\AppData\\Roaming\\npm\\node_modules\\@vue\\cli-service-global\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQpyZXF1aXJlKCJ0cmFja2luZy9idWlsZC90cmFja2luZy1taW4uanMiKTsNCnJlcXVpcmUoInRyYWNraW5nL2J1aWxkL2RhdGEvZmFjZS1taW4uanMiKTsNCnJlcXVpcmUoInRyYWNraW5nL2J1aWxkL2RhdGEvbW91dGgtbWluLmpzIik7DQpyZXF1aXJlKCJ0cmFja2luZy9leGFtcGxlcy9hc3NldHMvc3RhdHMubWluLmpzIik7DQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICJUYWtlUGhvdG9zQ2xhc3MiLA0KICBkYXRhKCkgew0KICAgIHJldHVybiB7fTsNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIGNoZWNrRmFjZSgpIHsNCiAgICAgIHZhciB2aWRlbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ2aWRlbyIpOw0KICAgICAgdmFyIGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjYW52YXMiKTsNCiAgICAgIHZhciBjb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQoIjJkIik7DQoNCiAgICAgIHZhciB0cmFja2VyID0gbmV3IHRyYWNraW5nLk9iamVjdFRyYWNrZXIoImZhY2UiKTsNCiAgICAgIHRyYWNrZXIuc2V0SW5pdGlhbFNjYWxlKDQpOw0KICAgICAgdHJhY2tlci5zZXRTdGVwU2l6ZSgyKTsNCiAgICAgIHRyYWNrZXIuc2V0RWRnZXNEZW5zaXR5KDAuMSk7DQoNCiAgICAgIHRoaXMudHJhY2tlclRhc2sgPSB0cmFja2luZy50cmFjaygiI3ZpZGVvIiwgdHJhY2tlciwgeyBjYW1lcmE6IHRydWUgfSk7DQoNCiAgICAgIHRyYWNrZXIub24oInRyYWNrIiwgZnVuY3Rpb24gKGV2ZW50KSB7DQogICAgICAgIGlmIChldmVudC5kYXRhLmxlbmd0aCA8PSAwKSB7DQogICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQogICAgICAgIGNvbnRleHQuY2xlYXJSZWN0KDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCk7DQogICAgICAgIGV2ZW50LmRhdGEuZm9yRWFjaChmdW5jdGlvbiAocmVjdCkgew0KICAgICAgICAgIGNvbnRleHQuc3Ryb2tlU3R5bGUgPSAnI2E2NGNlYic7DQogICAgICAgICAgY29udGV4dC5zdHJva2VSZWN0KHJlY3QueCwgcmVjdC55LCByZWN0LndpZHRoLCByZWN0LmhlaWdodCk7DQogICAgICAgICAgY29udGV4dC5mb250ID0gJzExcHggSGVsdmV0aWNhJzsNCiAgICAgICAgICBjb250ZXh0LmZpbGxTdHlsZSA9ICIjZmZmIjsNCiAgICAgICAgICBjb250ZXh0LmZpbGxUZXh0KCd4OiAnICsgcmVjdC54ICsgJ3B4JywgcmVjdC54ICsgcmVjdC53aWR0aCArIDUsIHJlY3QueSArIDExKTsNCiAgICAgICAgICBjb250ZXh0LmZpbGxUZXh0KCd5OiAnICsgcmVjdC55ICsgJ3B4JywgcmVjdC54ICsgcmVjdC53aWR0aCArIDUsIHJlY3QueSArIDIyKTsNCiAgICAgICAgfSk7DQogICAgICB9KTsNCiAgICB9LA0KICAgIHN1Ym1pdCgpIHsNCiAgICAgIGxldCB0aGF0ID0gdGhpczsNCiAgICAgIGxldCBjYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY2FudmFzIik7DQogICAgICBsZXQgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KCIyZCIpOw0KICAgICAgbGV0IHZpZGVvID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInZpZGVvIik7DQogICAgICBjb250ZXh0LmRyYXdJbWFnZSh2aWRlbywgMCwgMCwgMTAwMCwgNzAwKTsNCiAgICAgIGNhbnZhcy50b0Jsb2IoKGJsb2IpID0+IHsNCiAgICAgICAgLy8gYXhpb3MucG9zdCh7IGZhY2VVcmw6IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYikgfSkudGhlbigocmVzKSA9PiB7DQogICAgICAgIC8vICAgY29uc29sZS5sb2coIuS4iuS8oOaIkOWKnyIpOw0KICAgICAgICAvLyB9KTsNCiAgICAgICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7DQogICAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGJsb2IpOw0KICAgICAgICBjb25zb2xlLmxvZyhyZWFkZXIpOw0KICAgICAgfSk7DQogICAgfSwNCiAgICBnZXRDb21wZXRlbmNlKCkgew0KICAgICAgdmFyIF90aGlzID0gdGhpczsNCiAgICAgIHRoaXMudGhpc0NhbmNhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjYW52YXMiKTsNCiAgICAgIHRoaXMudGhpc0NvbnRleHQgPSB0aGlzLnRoaXNDYW5jYXMuZ2V0Q29udGV4dCgiMmQiKTsNCiAgICAgIHRoaXMudGhpc1ZpZGVvID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInZpZGVvIik7DQogICAgICAvLyDml6fniYjmnKzmtY/op4jlmajlj6/og73moLnmnKzkuI3mlK/mjIFtZWRpYURldmljZXPvvIzmiJHku6zpppblhYjorr7nva7kuIDkuKrnqbrlr7nosaENCiAgICAgIGlmIChuYXZpZ2F0b3IubWVkaWFEZXZpY2VzID09PSB1bmRlZmluZWQpIHsNCiAgICAgICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcyA9IHt9Ow0KICAgICAgfQ0KICAgICAgLy8g5LiA5Lqb5rWP6KeI5Zmo5a6e546w5LqG6YOo5YiGbWVkaWFEZXZpY2Vz77yM5oiR5Lus5LiN6IO95Y+q5YiG6YWN5LiA5Liq5a+56LGhDQogICAgICAvLyDkvb/nlKhnZXRVc2VyTWVkaWHvvIzlm6DkuLrlroPkvJropobnm5bnjrDmnInnmoTlsZ7mgKfjgIINCiAgICAgIC8vIOi/memHjO+8jOWmguaenOe8uuWwkWdldFVzZXJNZWRpYeWxnuaAp++8jOWwsea3u+WKoOWug+OAgg0KICAgICAgaWYgKG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhID09PSB1bmRlZmluZWQpIHsNCiAgICAgICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEgPSBmdW5jdGlvbiAoY29uc3RyYWludHMpIHsNCiAgICAgICAgICAvLyDpppblhYjojrflj5bnjrDlrZjnmoRnZXRVc2VyTWVkaWEo5aaC5p6c5a2Y5ZyoKQ0KICAgICAgICAgIHZhciBnZXRVc2VyTWVkaWEgPQ0KICAgICAgICAgICAgICBuYXZpZ2F0b3Iud2Via2l0R2V0VXNlck1lZGlhIHx8DQogICAgICAgICAgICAgIG5hdmlnYXRvci5tb3pHZXRVc2VyTWVkaWEgfHwNCiAgICAgICAgICAgICAgbmF2aWdhdG9yLmdldFVzZXJNZWRpYTsNCiAgICAgICAgICAvLyDmnInkupvmtY/op4jlmajkuI3mlK/mjIHvvIzkvJrov5Tlm57plJnor6/kv6Hmga8NCiAgICAgICAgICAvLyDkv53mjIHmjqXlj6PkuIDoh7QNCiAgICAgICAgICBpZiAoIWdldFVzZXJNZWRpYSkgew0KICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KA0KICAgICAgICAgICAgICAgIG5ldyBFcnJvcigiZ2V0VXNlck1lZGlhIGlzIG5vdCBpbXBsZW1lbnRlZCBpbiB0aGlzIGJyb3dzZXIiKQ0KICAgICAgICAgICAgKTsNCiAgICAgICAgICB9DQogICAgICAgICAgLy8g5ZCm5YiZ77yM5L2/55SoUHJvbWlzZeWwhuiwg+eUqOWMheijheWIsOaXp+eahG5hdmlnYXRvci5nZXRVc2VyTWVkaWENCiAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgew0KICAgICAgICAgICAgZ2V0VXNlck1lZGlhLmNhbGwobmF2aWdhdG9yLCBjb25zdHJhaW50cywgcmVzb2x2ZSwgcmVqZWN0KTsNCiAgICAgICAgICB9KTsNCiAgICAgICAgfTsNCiAgICAgIH0NCiAgICAgIHZhciBjb25zdHJhaW50cyA9IHsNCiAgICAgICAgYXVkaW86IGZhbHNlLA0KICAgICAgICB2aWRlbzogew0KICAgICAgICAgIHdpZHRoOiB0aGlzLnZpZGVvV2lkdGgsDQogICAgICAgICAgaGVpZ2h0OiB0aGlzLnZpZGVvSGVpZ2h0LA0KICAgICAgICAgIHRyYW5zZm9ybTogInNjYWxlWCgtMSkiLA0KICAgICAgICB9LA0KICAgICAgfTsNCiAgICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMNCiAgICAgICAgICAuZ2V0VXNlck1lZGlhKGNvbnN0cmFpbnRzKQ0KICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChzdHJlYW0pIHsNCiAgICAgICAgICAgIC8vIOaXp+eahOa1j+iniOWZqOWPr+iDveayoeaciXNyY09iamVjdA0KICAgICAgICAgICAgaWYgKCJzcmNPYmplY3QiIGluIF90aGlzLnRoaXNWaWRlbykgew0KICAgICAgICAgICAgICBfdGhpcy50aGlzVmlkZW8uc3JjT2JqZWN0ID0gc3RyZWFtOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgLy8g6YG/5YWN5Zyo5paw55qE5rWP6KeI5Zmo5Lit5L2/55So5a6D77yM5Zug5Li65a6D5q2j5Zyo6KKr5byD55So44CCDQogICAgICAgICAgICAgIF90aGlzLnRoaXNWaWRlby5zcmMgPSB3aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChzdHJlYW0pOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgX3RoaXMudGhpc1ZpZGVvLm9ubG9hZGVkbWV0YWRhdGEgPSBmdW5jdGlvbiAoZSkgew0KICAgICAgICAgICAgICBfdGhpcy50aGlzVmlkZW8ucGxheSgpOw0KICAgICAgICAgICAgfTsNCiAgICAgICAgICB9KQ0KICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7DQogICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpOw0KICAgICAgICAgIH0pOw0KICAgIH0sDQogICAgZGUoKSB7DQogICAgICAvLyDlgZzmraLkvqbmtYsNCiAgICAgIHRoaXMudHJhY2tlclRhc2suc3RvcCgpOw0KICAgICAgLy8g5YWz6Zet5pGE5YOP5aS0DQogICAgICB0aGlzLnRyYWNrZXJUYXNrLmNsb3NlQ2FtZXJhKCk7DQogICAgfSwNCiAgfSwNCiAgZGVzdHJveWVkKCkgew0KICAgIC8vIOWBnOatouS+pua1iw0KICAgIHRoaXMudHJhY2tlclRhc2suc3RvcCgpOw0KICAgIC8vIOWFs+mXreaRhOWDj+WktA0KICAgIHRoaXMudHJhY2tlclRhc2suY2xvc2VDYW1lcmEoKTsNCiAgfSwNCn07DQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAwBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":".","sourcesContent":["<template>\r\n  <div class=\"TakePhotosClass\">\r\n    <video\r\n        id=\"video\"\r\n        width=\"1000\"\r\n        height=\"700\"\r\n        preload\r\n        autoplay\r\n        loop\r\n        muted\r\n    ></video>\r\n    <canvas id=\"canvas\" width=\"1000\" height=\"700\"></canvas>\r\n    <div class=\"buttonDiv\">\r\n      <button type=\"button\" @click=\"submit\" style=\"font-size: 3vw;\">提取照片</button>\r\n      <button type=\"button\" name=\"button\" @click=\"checkFace\" style=\"font-size: 3vw;\">检测人脸</button>\r\n      <button type=\"button\" name=\"button\" @click=\"getCompetence\" style=\"font-size: 3vw;\">\r\n        打开摄像头\r\n      </button>\r\n      <button type=\"button\" name=\"button\" @click=\"de\" style=\"font-size: 3vw;\">停</button>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nrequire(\"tracking/build/tracking-min.js\");\r\nrequire(\"tracking/build/data/face-min.js\");\r\nrequire(\"tracking/build/data/mouth-min.js\");\r\nrequire(\"tracking/examples/assets/stats.min.js\");\r\nexport default {\r\n  name: \"TakePhotosClass\",\r\n  data() {\r\n    return {};\r\n  },\r\n  methods: {\r\n    checkFace() {\r\n      var video = document.getElementById(\"video\");\r\n      var canvas = document.getElementById(\"canvas\");\r\n      var context = canvas.getContext(\"2d\");\r\n\r\n      var tracker = new tracking.ObjectTracker(\"face\");\r\n      tracker.setInitialScale(4);\r\n      tracker.setStepSize(2);\r\n      tracker.setEdgesDensity(0.1);\r\n\r\n      this.trackerTask = tracking.track(\"#video\", tracker, { camera: true });\r\n\r\n      tracker.on(\"track\", function (event) {\r\n        if (event.data.length <= 0) {\r\n          return;\r\n        }\r\n        context.clearRect(0, 0, canvas.width, canvas.height);\r\n        event.data.forEach(function (rect) {\r\n          context.strokeStyle = '#a64ceb';\r\n          context.strokeRect(rect.x, rect.y, rect.width, rect.height);\r\n          context.font = '11px Helvetica';\r\n          context.fillStyle = \"#fff\";\r\n          context.fillText('x: ' + rect.x + 'px', rect.x + rect.width + 5, rect.y + 11);\r\n          context.fillText('y: ' + rect.y + 'px', rect.x + rect.width + 5, rect.y + 22);\r\n        });\r\n      });\r\n    },\r\n    submit() {\r\n      let that = this;\r\n      let canvas = document.getElementById(\"canvas\");\r\n      let context = canvas.getContext(\"2d\");\r\n      let video = document.getElementById(\"video\");\r\n      context.drawImage(video, 0, 0, 1000, 700);\r\n      canvas.toBlob((blob) => {\r\n        // axios.post({ faceUrl: URL.createObjectURL(blob) }).then((res) => {\r\n        //   console.log(\"上传成功\");\r\n        // });\r\n        var reader = new FileReader();\r\n        reader.readAsDataURL(blob);\r\n        console.log(reader);\r\n      });\r\n    },\r\n    getCompetence() {\r\n      var _this = this;\r\n      this.thisCancas = document.getElementById(\"canvas\");\r\n      this.thisContext = this.thisCancas.getContext(\"2d\");\r\n      this.thisVideo = document.getElementById(\"video\");\r\n      // 旧版本浏览器可能根本不支持mediaDevices，我们首先设置一个空对象\r\n      if (navigator.mediaDevices === undefined) {\r\n        navigator.mediaDevices = {};\r\n      }\r\n      // 一些浏览器实现了部分mediaDevices，我们不能只分配一个对象\r\n      // 使用getUserMedia，因为它会覆盖现有的属性。\r\n      // 这里，如果缺少getUserMedia属性，就添加它。\r\n      if (navigator.mediaDevices.getUserMedia === undefined) {\r\n        navigator.mediaDevices.getUserMedia = function (constraints) {\r\n          // 首先获取现存的getUserMedia(如果存在)\r\n          var getUserMedia =\r\n              navigator.webkitGetUserMedia ||\r\n              navigator.mozGetUserMedia ||\r\n              navigator.getUserMedia;\r\n          // 有些浏览器不支持，会返回错误信息\r\n          // 保持接口一致\r\n          if (!getUserMedia) {\r\n            return Promise.reject(\r\n                new Error(\"getUserMedia is not implemented in this browser\")\r\n            );\r\n          }\r\n          // 否则，使用Promise将调用包装到旧的navigator.getUserMedia\r\n          return new Promise(function (resolve, reject) {\r\n            getUserMedia.call(navigator, constraints, resolve, reject);\r\n          });\r\n        };\r\n      }\r\n      var constraints = {\r\n        audio: false,\r\n        video: {\r\n          width: this.videoWidth,\r\n          height: this.videoHeight,\r\n          transform: \"scaleX(-1)\",\r\n        },\r\n      };\r\n      navigator.mediaDevices\r\n          .getUserMedia(constraints)\r\n          .then(function (stream) {\r\n            // 旧的浏览器可能没有srcObject\r\n            if (\"srcObject\" in _this.thisVideo) {\r\n              _this.thisVideo.srcObject = stream;\r\n            } else {\r\n              // 避免在新的浏览器中使用它，因为它正在被弃用。\r\n              _this.thisVideo.src = window.URL.createObjectURL(stream);\r\n            }\r\n            _this.thisVideo.onloadedmetadata = function (e) {\r\n              _this.thisVideo.play();\r\n            };\r\n          })\r\n          .catch((err) => {\r\n            console.log(err);\r\n          });\r\n    },\r\n    de() {\r\n      // 停止侦测\r\n      this.trackerTask.stop();\r\n      // 关闭摄像头\r\n      this.trackerTask.closeCamera();\r\n    },\r\n  },\r\n  destroyed() {\r\n    // 停止侦测\r\n    this.trackerTask.stop();\r\n    // 关闭摄像头\r\n    this.trackerTask.closeCamera();\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"css\" scoped>\r\n</style>\r\n"]}]}