{"remainingRequest":"C:\\Users\\86185\\AppData\\Roaming\\npm\\node_modules\\@vue\\cli-service-global\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Files\\Learning_Files\\Vue\\vue_test\\components\\TakePhotos\\index.vue?vue&type=style&index=0&id=6de5ab34&lang=less&scoped=true&","dependencies":[{"path":"D:\\Files\\Learning_Files\\Vue\\vue_test\\components\\TakePhotos\\index.vue","mtime":1645753957208},{"path":"C:\\Users\\86185\\AppData\\Roaming\\npm\\node_modules\\@vue\\cli-service-global\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\86185\\AppData\\Roaming\\npm\\node_modules\\@vue\\cli-service-global\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\86185\\AppData\\Roaming\\npm\\node_modules\\@vue\\cli-service-global\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\Files\\Learning_Files\\Vue\\node_modules\\less-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\86185\\AppData\\Roaming\\npm\\node_modules\\@vue\\cli-service-global\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\86185\\AppData\\Roaming\\npm\\node_modules\\@vue\\cli-service-global\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQouVGFrZVBob3Rvc0NsYXNzIHsNCiAgaGVpZ2h0OiAxMDB2aDsNCiAgd2lkdGg6IDEwMCU7DQogIHBvc2l0aW9uOiByZWxhdGl2ZTsNCiAgPiAqIHsNCiAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgbGVmdDogMDsNCiAgICByaWdodDogMDsNCiAgICBtYXJnaW46IGF1dG87DQogIH0NCiAgdmlkZW8sDQogIGNhbnZhcyB7DQogICAgdG9wOiAwOw0KICB9DQogIC5idXR0b25EaXYgew0KICAgIGJvdHRvbTogMTBweDsNCiAgfQ0KfQ0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":".","sourcesContent":["<template>\r\n  <div class=\"TakePhotosClass\">\r\n    <video\r\n        id=\"video\"\r\n        width=\"1000\"\r\n        height=\"700\"\r\n        preload\r\n        autoplay\r\n        loop\r\n        muted\r\n    ></video>\r\n    <canvas id=\"canvas\" width=\"1000\" height=\"700\"></canvas>\r\n    <div class=\"buttonDiv\">\r\n      <button type=\"button\" @click=\"submit\" style=\"font-size: 3vw;\">提取照片</button>\r\n      <button type=\"button\" name=\"button\" @click=\"checkFace\" style=\"font-size: 3vw;\">检测人脸</button>\r\n      <button type=\"button\" name=\"button\" @click=\"getCompetence\" style=\"font-size: 3vw;\">\r\n        打开摄像头\r\n      </button>\r\n      <button type=\"button\" name=\"button\" @click=\"de\" style=\"font-size: 3vw;\">停</button>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nrequire(\"tracking/build/tracking-min.js\");\r\nrequire(\"tracking/build/data/face-min.js\");\r\nrequire(\"tracking/build/data/mouth-min.js\");\r\nrequire(\"tracking/examples/assets/stats.min.js\");\r\nexport default {\r\n  name: \"TakePhotosClass\",\r\n  data() {\r\n    return {};\r\n  },\r\n  methods: {\r\n    checkFace() {\r\n      var video = document.getElementById(\"video\");\r\n      var canvas = document.getElementById(\"canvas\");\r\n      var context = canvas.getContext(\"2d\");\r\n\r\n      var tracker = new tracking.ObjectTracker(\"face\");\r\n      tracker.setInitialScale(4);\r\n      tracker.setStepSize(2);\r\n      tracker.setEdgesDensity(0.1);\r\n\r\n      this.trackerTask = tracking.track(\"#video\", tracker, { camera: true });\r\n\r\n      tracker.on(\"track\", function (event) {\r\n        if (event.data.length <= 0) {\r\n          return;\r\n        }\r\n        context.clearRect(0, 0, canvas.width, canvas.height);\r\n        event.data.forEach(function (rect) {\r\n          context.strokeStyle = '#a64ceb';\r\n          context.strokeRect(rect.x, rect.y, rect.width, rect.height);\r\n          context.font = '11px Helvetica';\r\n          context.fillStyle = \"#fff\";\r\n          context.fillText('x: ' + rect.x + 'px', rect.x + rect.width + 5, rect.y + 11);\r\n          context.fillText('y: ' + rect.y + 'px', rect.x + rect.width + 5, rect.y + 22);\r\n        });\r\n      });\r\n    },\r\n    submit() {\r\n      let that = this;\r\n      let canvas = document.getElementById(\"canvas\");\r\n      let context = canvas.getContext(\"2d\");\r\n      let video = document.getElementById(\"video\");\r\n      context.drawImage(video, 0, 0, 1000, 700);\r\n      canvas.toBlob((blob) => {\r\n        // axios.post({ faceUrl: URL.createObjectURL(blob) }).then((res) => {\r\n        //   console.log(\"上传成功\");\r\n        // });\r\n        var reader = new FileReader();\r\n        reader.readAsDataURL(blob);\r\n        console.log(reader);\r\n      });\r\n    },\r\n    getCompetence() {\r\n      var _this = this;\r\n      this.thisCancas = document.getElementById(\"canvas\");\r\n      this.thisContext = this.thisCancas.getContext(\"2d\");\r\n      this.thisVideo = document.getElementById(\"video\");\r\n      // 旧版本浏览器可能根本不支持mediaDevices，我们首先设置一个空对象\r\n      if (navigator.mediaDevices === undefined) {\r\n        navigator.mediaDevices = {};\r\n      }\r\n      // 一些浏览器实现了部分mediaDevices，我们不能只分配一个对象\r\n      // 使用getUserMedia，因为它会覆盖现有的属性。\r\n      // 这里，如果缺少getUserMedia属性，就添加它。\r\n      if (navigator.mediaDevices.getUserMedia === undefined) {\r\n        navigator.mediaDevices.getUserMedia = function (constraints) {\r\n          // 首先获取现存的getUserMedia(如果存在)\r\n          var getUserMedia =\r\n              navigator.webkitGetUserMedia ||\r\n              navigator.mozGetUserMedia ||\r\n              navigator.getUserMedia;\r\n          // 有些浏览器不支持，会返回错误信息\r\n          // 保持接口一致\r\n          if (!getUserMedia) {\r\n            return Promise.reject(\r\n                new Error(\"getUserMedia is not implemented in this browser\")\r\n            );\r\n          }\r\n          // 否则，使用Promise将调用包装到旧的navigator.getUserMedia\r\n          return new Promise(function (resolve, reject) {\r\n            getUserMedia.call(navigator, constraints, resolve, reject);\r\n          });\r\n        };\r\n      }\r\n      var constraints = {\r\n        audio: false,\r\n        video: {\r\n          width: this.videoWidth,\r\n          height: this.videoHeight,\r\n          transform: \"scaleX(-1)\",\r\n        },\r\n      };\r\n      navigator.mediaDevices\r\n          .getUserMedia(constraints)\r\n          .then(function (stream) {\r\n            // 旧的浏览器可能没有srcObject\r\n            if (\"srcObject\" in _this.thisVideo) {\r\n              _this.thisVideo.srcObject = stream;\r\n            } else {\r\n              // 避免在新的浏览器中使用它，因为它正在被弃用。\r\n              _this.thisVideo.src = window.URL.createObjectURL(stream);\r\n            }\r\n            _this.thisVideo.onloadedmetadata = function (e) {\r\n              _this.thisVideo.play();\r\n            };\r\n          })\r\n          .catch((err) => {\r\n            console.log(err);\r\n          });\r\n    },\r\n    de() {\r\n      // 停止侦测\r\n      this.trackerTask.stop();\r\n      // 关闭摄像头\r\n      this.trackerTask.closeCamera();\r\n    },\r\n  },\r\n  destroyed() {\r\n    // 停止侦测\r\n    this.trackerTask.stop();\r\n    // 关闭摄像头\r\n    this.trackerTask.closeCamera();\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.TakePhotosClass {\r\n  height: 100vh;\r\n  width: 100%;\r\n  position: relative;\r\n  > * {\r\n    position: absolute;\r\n    left: 0;\r\n    right: 0;\r\n    margin: auto;\r\n  }\r\n  video,\r\n  canvas {\r\n    top: 0;\r\n  }\r\n  .buttonDiv {\r\n    bottom: 10px;\r\n  }\r\n}\r\n</style>\r\n"]}]}